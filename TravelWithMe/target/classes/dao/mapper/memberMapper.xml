<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="dao.IMemberDao">
	
	<!-- 아이디로 비밀번호 조회 -->
	<select id = "selectPw" parameterType="String" resultType="String">
		select mpw from member where mid=#{mid}
	</select>
	
	<!-- 아이디로 여행취향 조회 -->
	<select id="selectLikecodeById" parameterType="String" resultType="String">
		select likecode from mempick where mid = #{mid}
	</select>
	
	<!-- 아이디로 신뢰지수, 등급 등 조회 -->
	<select id="selectMemPoint" parameterType="String" resultType="java.util.HashMap">
		select b.mid mid, b.mpoint mpoint, b.mguidepoint mguidepoint, grade, nvl(cnt, 0) cnt
		from guiderating a, member b left join (select mid, count(*) cnt from board group by mid) c
		on b.mid = c.mid where mguidepoint between minpoint and maxpoint and b.mid = #{mid}
	</select>
	
	<!-- 아이디로 알림내역 조회 -->
	<select id="selectNoticeById" parameterType="String" resultType="notice">
		select b1.bkind, b1.btitle, b2.* from board b1, (select a1.*, a2.nkreason from notice a1, noticekind a2
        where a1.nkcode = a2.nkcode order by a1.noticetime desc) b2 where b1.bnum = b2.bnum and b2.mid = #{mid};
	</select>
	
	
	
	
</mapper>